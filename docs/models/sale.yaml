SaleKey:
  type: object
  required:
    - id
    - type
  properties:
    id:
      type: string
      example: "5"
    type:
      type: string
      enum:
        - "sales"

Sale:
  allOf:
    - $ref: '#/components/schemas/SaleKey'
    - type: object
      required: [relationships, attributes]
      properties:
        attributes:
          type: object
          required: [start_time, end_time, sale_type, sale_state, details]
          properties:
            start_time:
              type: string
              description: "time when the sale starts"
              format: "date-time"
              example: "2012-11-01T22:08:41+00:00"
            end_time:
              type: string
              description: "time when the sale expires"
              format: "date-time"
              example: "2012-11-01T22:08:41+00:00"
            sale_type:
              type: integer
              format: xdr.SaleType
              minimum: 1
              maximum: 3
              description: "type of sale"
              example: 2
            sale_state:
              type: integer
              format: SaleState
              minimum: 1
              maximum: 3
              description: "state of sale" # todo provide a list of sale states
              example: 2
            details:
              $ref: '#/components/schemas/Details'
              description: "free-form object to attach details to the sale"
        relationships:
          type: object
          properties:
            owner:
              description: "Owner of the sale"
              type: object
              properties:
                data:
                  type: object
                  $ref: '#/components/schemas/AccountKey'
            base_asset:
              description: "Base asset of the sale"
              type: object
              properties:
                data:
                  $ref: '#/components/schemas/AssetKey'
            quote_assets:
              description: "Quote assets specified for the sale"
              type: object
              properties:
                data:
                  type: array
                  items:
                    $ref: '#/components/schemas/AssetKey'
            default_quote_asset:
              description: "Quote asset specified as default for the sale" 
              type: object
              properties:
                data:
                  $ref: '#/components/schemas/AssetKey'

SaleRequest:
  allOf:
  - $ref: '#/components/schemas/Int64Key'
  - type: object
    properties:
      attributes:
        type: object
        properties:
          start_time:
            type: string
            description: "Start time of the sale"
            format: "date-time"
            example: "2012-11-01T22:08:41+00:00"
          end_time:
            type: string
            description: "End time of the sale"
            format: "date-time"
            example: "2012-11-01T22:08:41+00:00"
          sale_type:
            type: integer
            format: xdr.SaleType
            minimum: 1
            maximum: 3
            example: 1
            description: |
              * 1 - basic sale
              * 2 - crowdfunding sale
              * 3 - fixed price sale
          sale_state:
            type: integer
            format: SaleState
            minimum: 1
            maximum: 3
            example: 1
            description: |
              * 1 - open
              * 2 - closed
              * 3 - cancelled
          details:
            $ref: '#/components/schemas/Details'
      relationships:
        type: object
        properties:
          owner:
            type: object
            description: "Sale owner's account key"
            properties:
              data:
                type: object
                $ref: '#/components/schemas/AccountKey'
          base_asset:
            type: object
            description: "Asset key of the asset of the sale"
            properties:
              data:
                type: object
                $ref: '#/components/schemas/AssetKey'
          default_quote_asset:
            type: object
            description: "Default quote asset of the sale"
            properties:
              data:
                type: object
                $ref: '#/components/schemas/AssetKey'
          quote_assets:
            type: object
            description: "Quote assets of the sale"
            properties:
              data:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/AssetKey'


SaleQuoteAssetKey:
  type: object
  required:
    - id
    - type
  properties:
    id:
      type: string
      example: "5"
    type:
      type: string
      enum:
        - "sale-quote-assets"

SaleQuoteAsset:
  allOf:
    - $ref: '#/components/schemas/SaleQuoteAssetKey'
    - type: object
      required: [relationships, attributes]
      properties:
        attributes:
          type: object
          required:
            - price
            - current_cap
            - total_current_cap
            - hard_cap
            - soft_cap
          properties:
            price:
              type: integer
              format: Amount
            current_cap:
              type: integer
              format: Amount
            total_current_cap:
              type: integer
              format: Amount
            hard_cap:
              type: integer
              format: Amount
            soft_cap:
              type: integer
              format: Amount
        relationships:
          type: object
          properties:
            asset:
              type: object
              properties:
                data:
                  type: object
                  $ref: '#/components/schemas/AssetKey'